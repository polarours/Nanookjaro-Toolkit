# 🎨 Nanookjaro 前端文档

## 🌟 概述

Nanookjaro 前端是一个 Flutter 桌面应用程序，为系统监控和管理提供直观的用户界面。它具有玻璃态设计，使其区别于传统的系统监控工具。

前端通过 Dart FFI 与 C++ 后端通信，以检索系统信息和执行管理操作，确保良好的性能和无缝集成。

## 🧰 技术栈

- **框架**: 带有桌面嵌入的 Flutter 3.x
- **状态管理**: 用于响应式状态管理的 Riverpod
- **UI 组件**: 具有玻璃态设计的自定义组件
- **国际化**: 带有 ARB 文件的 Flutter 内置 i18n 支持
- **平台通道**: 用于原生通信的 dart:ffi

## 📁 项目结构

```
frontend/flutter/
├── lib/
│   ├── l10n/                  # 本地化文件
│   ├── providers/             # Riverpod providers 用于状态管理
│   ├── services/              # 业务逻辑和外部服务集成
│   ├── ui/
│   │   ├── dialogs/           # 对话框组件
│   │   ├── pages/             # 页面组件
│   │   ├── widgets/           # 可重用的组件
│   │   ├── app_shell.dart     # 主应用程序外壳
│   │   └── app_theme.dart     # 应用程序主题定义
│   └── main.dart              # 应用程序入口点
├── assets/                    # 应用程序资源
├── linux/                     # Linux 特定配置
├── windows/                   # Windows 特定配置
├── macos/                     # macOS 特定配置
├── pubspec.yaml               # Flutter 项目配置
└── README.md                  # Flutter 项目文档
```

## 🧩 关键组件

### 🚀 主应用程序

入口点是 `main.dart`，它设置了具有以下功能的 Flutter 应用程序：

1. **主题配置**
   - 浅色和深色主题
   - 自定义配色方案
   - 排版设置

2. **本地化**
   - 多语言支持
   - 动态语言切换

3. **路由**
   - 单页应用程序架构
   - 基于组件的导航

### 📊 状态管理

应用程序使用 Riverpod 进行状态管理，具有以下关键 providers：

1. **MetricsProvider**
   - 管理系统指标数据
   - 处理周期性数据刷新
   - 维护图表的历史数据

2. **UpdateProvider**
   - 管理包更新信息
   - 处理包管理操作

### 🎨 UI 组件

#### ✨ 玻璃态设计

应用程序具有玻璃态设计，包括：

1. **GlassCard 组件**
   - 磨砂玻璃效果
   - 动态悬停动画
   - 响应式设计

2. **极光背景**
   - 带有极光效果的动画背景
   - 动态颜色过渡

#### 📄 关键页面

1. **仪表板页面**
   - 系统概览
   - 实时指标
   - 快速操作按钮

2. **系统信息页面**
   - 详细的 CPU 信息
   - 内存使用详情
   - 磁盘和文件系统信息
   - GPU 详情
   - 网络信息

#### 💬 对话框

1. **Pacman 升级对话框**
   - 系统升级界面
   - 命令执行和输出显示

2. **代理配置对话框**
   - 代理设置管理

## 🔌 FFI 集成

前端通过 `NanookjaroBridge` 服务与后端通信：

### 关键函数

1. **getSystemSummaryJson()**
   - 检索系统摘要信息
   - 从后端返回 JSON 字符串

2. **pacmanSyncUpgradeJson()**
   - 启动系统升级
   - 返回升级结果

3. **pacmanListUpdatesJson()**
   - 列出可用更新
   - 返回更新信息

4. **setProxy()**
   - 配置代理设置
   - 返回配置状态

## 🌍 国际化

应用程序通过以下方式支持多种语言：

1. **ARB 文件**
   - 位于 `lib/l10n/`
   - 包含翻译的字符串

2. **代码生成**
   - 自动生成本地化类
   - 类型安全的本地化字符串访问

3. **运行时切换**
   - 动态语言更改
   - 持久化语言偏好设置

## ⚡ 性能考虑

1. **组件优化**
   - 高效的重建策略
   - 正确使用 const 构造函数
   - 重型组件的延迟加载

2. **数据处理**
   - 高效的 JSON 解析
   - 大数据集的内存管理
   - 频繁访问数据的缓存

3. **UI 响应性**
   - 异步操作
   - 长操作的进度指示器
   - 流畅的动画

## 🎨 自定义

### 🌗 主题

应用程序支持：

1. **浅色/深色模式**
   - 系统感知的主题选择
   - 手动主题切换

2. **颜色自定义**
   - 主色和辅色方案
   - 强调色调整

### 📐 布局

1. **响应式设计**
   - 适应不同的屏幕尺寸
   - 灵活的网格布局
   - 可滚动的内容区域

## 🛠 开发工作流

### ➕ 添加新功能

1. **创建 Provider**
   - 为新数据定义 Riverpod provider
   - 实现数据获取逻辑

2. **创建 UI 组件**
   - 设计和实现新组件
   - 与现有设计系统集成

3. **连接到后端**
   - 如需要扩展 FFI 桥接
   - 如需要向后端添加新函数

### 🧪 测试

1. **单元测试**
   - 测试单个函数和类
   - 模拟外部依赖

2. **组件测试**
   - 测试 UI 组件行为
   - 验证布局和交互

3. **集成测试**
   - 测试完整的工作流程
   - 验证 FFI 集成

## 🚀 构建和部署

### 🏗 为不同平台构建

1. **Linux**
   ```bash
   flutter build linux
   ```

2. **Windows**
   ```bash
   flutter build windows
   ```

3. **macOS**
   ```bash
   flutter build macos
   ```

### 📦 发布流程

1. **版本管理**
   - 更新 pubspec.yaml 中的版本
   - 在版本控制中标记发布

2. **资源准备**
   - 优化图像和图标
   - 验证所有资源都已包含

3. **分发**
   - 为目平台打包应用程序
   - 创建安装包